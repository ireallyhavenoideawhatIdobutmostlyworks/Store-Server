
name: CI unit and integration tests

on:

  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

  workflow_dispatch:

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
      - name: Step 1 - checkout main branch from github
        uses: actions/checkout@v2

      - name: Step 2 - Setup Java JDK
        uses: actions/setup-java@v1
        with:
          java-version: 11

  unit-tests-customer:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn test -Dtest=CustomerServiceTest

  integration-tests-customer:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn test -Dtest=CustomerControllerTest

  unit-tests-order:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn test -Dtest=OrderServiceTest

  integration-tests-order:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn test -Dtest=OrderControllerTest

  unit-tests-product:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn test -Dtest=ProductServiceTest

  integration-tests-product:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn test -Dtest=ProductControllerTest

  utils-tests:
    runs-on: ubuntu-latest
    steps:
      - name: use cache
        uses: actions/cache@v2
        with:
          java-version: 11
      - name: run tests
        run: mvn clean test -Dtest="**/service/**/*.java"